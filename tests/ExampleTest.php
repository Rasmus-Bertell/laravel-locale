<?php

$locales = [
    'de' => [
        'language' => 'de',
        'script' => null,
        'region' => null,
        'variant' => null,
        'extensions' => [],
        'privateUse' => null,
    ],
    'fr' => [
        'language' => 'fr',
        'script' => null,
        'region' => null,
        'variant' => null,
        'extensions' => [],
        'privateUse' => null,
    ],
    'ja' => [
        'language' => 'ja',
        'script' => null,
        'region' => null,
        'variant' => null,
        'extensions' => [],
        'privateUse' => null,
    ],
    'zh-Hant' => [
        'language' => 'zh',
        'script' => 'Hant',
        'region' => null,
        'variant' => null,
        'extensions' => [],
        'privateUse' => null,
    ],
    'zh-Hans' => [
        'language' => 'zh',
        'script' => 'Hans',
        'region' => null,
        'variant' => null,
        'extensions' => [],
        'privateUse' => null,
    ],
    'sr-Cyrl' => [
        'language' => 'sr',
        'script' => 'Cyrl',
        'region' => null,
        'variant' => null,
        'extensions' => [],
        'privateUse' => null,
    ],
    'sr-Latn' => [
        'language' => 'sr',
        'script' => 'Latn',
        'region' => null,
        'variant' => null,
        'extensions' => [],
        'privateUse' => null,
    ],
    'zh-Hans-CN' => [
        'language' => 'zh',
        'script' => 'Hans',
        'region' => 'CN',
        'variant' => null,
        'extensions' => [],
        'privateUse' => null,
    ],
    'sr-Latn-CS' => [
        'language' => 'sr',
        'script' => 'Latn',
        'region' => 'CS',
        'variant' => null,
        'extensions' => [],
        'privateUse' => null,
    ],
    'sl-rozaj' => [
        'language' => 'sl',
        'script' => null,
        'region' => null,
        'variant' => 'rozaj',
        'extensions' => [],
        'privateUse' => null,
    ],
    'sl-nedis' => [
        'language' => 'sl',
        'script' => null,
        'region' => null,
        'variant' => 'nedis',
        'extensions' => [],
        'privateUse' => null,
    ],
    'de-CH-1901' => [
        'language' => 'de',
        'script' => null,
        'region' => 'CH',
        'variant' => '1901',
        'extensions' => [],
        'privateUse' => null,
    ],
    'sl-IT-nedis' => [
        'language' => 'sl',
        'script' => null,
        'region' => 'IT',
        'variant' => 'nedis',
        'extensions' => [],
        'privateUse' => null,
    ],
    'sl-Latn-IT-nedis' => [
        'language' => 'sl',
        'script' => 'Latn',
        'region' => 'IT',
        'variant' => 'nedis',
        'extensions' => [],
        'privateUse' => null,
    ],
    'de-DE' => [
        'language' => 'de',
        'script' => null,
        'region' => 'DE',
        'variant' => null,
        'extensions' => [],
        'privateUse' => null,
    ],
    'en-US' => [
        'language' => 'en',
        'script' => null,
        'region' => 'US',
        'variant' => null,
        'extensions' => [],
        'privateUse' => null,
    ],
    'es-419' => [
        'language' => 'es',
        'script' => null,
        'region' => '419',
        'variant' => null,
        'extensions' => [],
        'privateUse' => null,
    ],
    'de-CH-x-phonebk' => [
        'language' => 'de',
        'script' => null,
        'region' => 'CH',
        'variant' => null,
        'extensions' => [],
        'privateUse' => 'x-phonebk',
    ],
    'az-Arab-x-AZE-derbend' => [
        'language' => 'az',
        'script' => 'Arab',
        'region' => null,
        'variant' => null,
        'extensions' => [],
        'privateUse' => 'x-AZE-derbend',
    ],
    'zh-min' => [
        'language' => 'zh-min',
        'script' => null,
        'region' => null,
        'variant' => null,
        'extensions' => [],
        'privateUse' => null,
    ],
    'zh-min-nan-Hant-CN' => [
        'language' => 'zh-min-nan',
        'script' => 'Hant',
        'region' => 'CN',
        'variant' => null,
        'extensions' => [],
        'privateUse' => null,
    ],
    'qaa-Qaaa-QM-x-southern' => [
        'language' => 'qaa',
        'script' => 'Qaaa',
        'region' => 'QM',
        'variant' => null,
        'extensions' => [],
        'privateUse' => 'x-southern',
    ],
    'de-Qaaa' => [
        'language' => 'de',
        'script' => 'Qaaa',
        'region' => null,
        'variant' => null,
        'extensions' => [],
        'privateUse' => null,
    ],
    'sr-Latn-QM' => [
        'language' => 'sr',
        'script' => 'Latn',
        'region' => 'QM',
        'variant' => null,
        'extensions' => [],
        'privateUse' => null,
    ],
    'sr-Qaaa-CS' => [
        'language' => 'sr',
        'script' => 'Qaaa',
        'region' => 'CS',
        'variant' => null,
        'extensions' => [],
        'privateUse' => null,
    ],
    'en-US-u-islamCal' => [
        'language' => 'en',
        'script' => null,
        'region' => 'US',
        'variant' => null,
        'extensions' => ['u' => 'islamCal'],
        'privateUse' => null,
    ],
    'zh-CN-a-myExt-x-private' => [
        'language' => 'zh',
        'script' => null,
        'region' => 'CN',
        'variant' => null,
        'extensions' => ['a' => 'myExt'],
        'privateUse' => 'x-private',
    ],
    'en-a-myExt-b-another' => [
        'language' => 'en',
        'script' => null,
        'region' => null,
        'variant' => null,
        'extensions' => ['a' => 'myExt', 'b' => 'another'],
        'privateUse' => null,
    ],

    // Invalid tags
    'de-419-DE' => 'InvalidArgumentException',
    'a-DE' => 'InvalidArgumentException',
    'ar-a-aaa-b-bbb-a-ccc' => 'InvalidArgumentException',
];

foreach ($locales as $locale => $expect) {
    it("is valid locale: {$locale}", function () use ($locale, $expect) {
        $valid = Bertell\Locale\Locale::isValid($locale);

        expect($valid)->toBe($expect !== 'InvalidArgumentException');
    });

    it("can parse a locale: {$locale}", function () use ($locale, $expect) {
        if ($expect === 'InvalidArgumentException') {
            expect(fn () => Bertell\Locale\Locale::parseLocale($locale))->toThrow(\InvalidArgumentException::class);
        } else {
            $parsed = Bertell\Locale\Locale::parseLocale($locale);

            expect($parsed->language)->toBe($expect['language']);
            expect($parsed->script)->toBe($expect['script']);
            expect($parsed->region)->toBe($expect['region']);
            expect($parsed->variant)->toBe($expect['variant']);
            expect($parsed->extensions)->toBe($expect['extensions']);
            expect($parsed->privateUse)->toBe($expect['privateUse']);
        }
    });
}
